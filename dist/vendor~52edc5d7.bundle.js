(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{c925:function(e,t,n){"use strict";(function(e){var r=n("284h"),u=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=u(n("o0o1")),i=u(n("yXPU")),c=u(n("lwsE")),o=u(n("W8MJ")),l=u(n("a1gu")),s=u(n("Nsbk")),f=u(n("7W2i")),d=u(n("MIez")),p=r(n("ROq3")),v=n("F+MN"),k=u(n("78si")),h=u(n("GwxU")),b=u(n("UYLU")),y=u(n("O1cq")),w=u(n("pk5N")),m=r(n("+nw1")),x=n("MPB0"),g=u(n("YRtA")),P=u(n("r6PA")),T=n("WdoV"),B=T.networks.bitcoin,K={name:"Blockcypher",account:"https://live.blockcypher.com/btc/address/{x}",transaction:"https://live.blockcypher.com/btc/tx/{x}",block:"https://live.blockcypher.com/btc/block/{x}"},C=function(t){function n(){return(0,c.default)(this,n),(0,l.default)(this,(0,s.default)(n).call(this,v.Blockchains.BTC,p.BLOCKCHAIN_SUPPORT))}var r,u,d,C,S,_,E;return(0,f.default)(n,t),(0,o.default)(n,[{key:"bip",value:function(){return"44'/0'/0'/0/"}},{key:"bustCache",value:function(){}},{key:"defaultExplorer",value:function(){return K}},{key:"accountFormatter",value:function(e){return"".concat(e.publicKey)}},{key:"returnableAccount",value:function(e){return{address:e.publicKey,blockchain:v.Blockchains.BTC}}},{key:"contractPlaceholder",value:function(){return"..."}},{key:"checkNetwork",value:function(e){return Promise.race([new Promise((function(e){return setTimeout((function(){return e(null)}),2e3)})),new Promise((function(e){return setTimeout((function(){return e(!0)}),10)}))])}},{key:"getEndorsedNetwork",value:function(){return new k.default("Bitcoin Mainnet","https","btcnodes.get-scatter.com",443,v.Blockchains.BTC,"1")}},{key:"isEndorsedNetwork",value:function(e){var t=this.getEndorsedNetwork();return e.blockchain===v.Blockchains.BTC&&e.chainId===t.chainId}},{key:"getChainId",value:(E=(0,i.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",1);case 1:case"end":return e.stop()}}),e)}))),function(e){return E.apply(this,arguments)})},{key:"usesResources",value:function(){return!1}},{key:"hasAccountActions",value:function(){return!1}},{key:"accountsAreImported",value:function(){return!1}},{key:"isValidRecipient",value:function(e){return this.validPublicKey(e)}},{key:"privateToPublic",value:function(e){var t=("string"==typeof e?T.ECPair.fromWIF(e,B):T.ECPair.fromPrivateKey(e,{network:B})).publicKey;return T.payments.p2pkh({pubkey:t,network:B}).address}},{key:"validPrivateKey",value:function(e){return 52===("string"==typeof e?e:this.bufferToHexPrivate(e)).length}},{key:"validPublicKey",value:function(e){return 34===e.length}},{key:"bufferToHexPrivate",value:function(t){return T.ECPair.fromPrivateKey(e.from(t),{network:B}).toWIF()}},{key:"hexPrivateToBuffer",value:function(e){return T.ECPair.fromWIF(e,B).privateKey}},{key:"hasUntouchableTokens",value:function(){return!1}},{key:"balanceFor",value:(_=(0,i.default)(a.default.mark((function e(t){var n=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,x.GET)("btc/balance/".concat(t.publicKey)).then((function(e){var r=n.defaultToken().clone();return r.amount=parseInt(e[t.publicKey].final_balance)/1e8,r})));case 1:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)})},{key:"balancesFor",value:(S=(0,i.default)(a.default.mark((function e(t){var n;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.balanceFor(t);case 2:return n=e.sent,e.abrupt("return",n?[n]:[]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"defaultDecimals",value:function(){return 8}},{key:"defaultToken",value:function(){return new h.default(v.Blockchains.BTC,"btc","BTC","BTC",this.defaultDecimals(),"1")}},{key:"actionParticipants",value:function(e){return b.default.flatten(e.messages.map((function(e){return e.authorization})))}},{key:"transfer",value:(C=(0,i.default)(a.default.mark((function e(t){var n,r,u,c,o,l=this;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.account,r=t.to,u=t.amount,c=t.promptForSignature,o=void 0===c||c,u*=1e8,e.prev=2,e.abrupt("return",new Promise(function(){var e=(0,i.default)(a.default.mark((function e(t,i){var c,s,f,d,p,k,h,b,y,w,m,g,K,C;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=new T.TransactionBuilder(B)).setVersion(1),c.addOutput(r,u),e.next=5,(0,x.GET)("btc/unspent/".concat(n.publicKey)).then((function(e){return e.unspent_outputs})).catch((function(){return null}));case 5:if(s=e.sent){e.next=8;break}return e.abrupt("return",t({error:"There was a problem loading UTXOs for ".concat(n.publicKey)}));case 8:f=0,d=!0,p=!1,k=void 0,e.prev=12,h=s[Symbol.iterator]();case 14:if(d=(b=h.next()).done){e.next=23;break}if(y=b.value,c.addInput(y.tx_hash_big_endian,y.tx_output_n),!((f+=y.value)>=u)){e.next=20;break}return e.abrupt("break",23);case 20:d=!0,e.next=14;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(12),p=!0,k=e.t0;case 29:e.prev=29,e.prev=30,d||null==h.return||h.return();case 32:if(e.prev=32,!p){e.next=35;break}throw k;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return e.next=39,(0,x.GET)("fees").then((function(e){return e.btc})).catch((function(){return null}));case 39:if(w=e.sent){e.next=42;break}return e.abrupt("return",t({error:"Couldn't get fee"}));case 42:if(m=c.buildIncomplete().toHex().length*w,!((g=f-(u+m))<0)){e.next=46;break}return e.abrupt("return",t({error:"Insufficient BTC: ".concat(f,". (Most likely due to fees, you need to leave ").concat(m," worth)")}));case 46:if(g&&c.addOutput(n.publicKey,g),K={transaction:{from:n.publicKey,to:r,amount:u/1e8,fee:m/1e8},unsigned:c.buildIncomplete().toHex(),blockchain:v.Blockchains.BTC,network:n.network(),requiredFields:{},abi:null},!o){e.next=54;break}return e.next=51,l.signerWithPopup(K,n,(function(e){return t(e)}),null);case 51:e.t1=e.sent,e.next=57;break;case 54:return e.next=56,P.default.sign(n.network(),K.unsigned,n.publicKey,!1,!1);case 56:e.t1=e.sent;case 57:if(C=e.t1){e.next=60;break}return e.abrupt("return");case 60:return e.next=62,(0,x.POST)("btc/pushtx",{signed:C}).then((function(e){e.indexOf("Transaction Submitted")>-1?t({txid:T.Transaction.fromHex(C).getId()}):t({error:e})})).catch((function(e){console.error(e),t({error:e})}));case 62:case"end":return e.stop()}}),e,null,[[12,25,29,37],[30,,32,36]])})));return function(t,n){return e.apply(this,arguments)}}()));case 6:e.prev=6,e.t0=e.catch(2),console.error(e.t0),resolve({error:e.t0});case 10:case"end":return e.stop()}}),e,null,[[2,6]])}))),function(e){return C.apply(this,arguments)})},{key:"signer",value:(d=(0,i.default)(a.default.mark((function t(n,r){var u,i,c,o=arguments;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.length>2&&void 0!==o[2]&&o[2],o.length>3&&void 0!==o[3]&&o[3],u=o.length>4&&void 0!==o[4]?o[4]:null,t.prev=3,u){t.next=8;break}return t.next=7,y.default.publicToPrivate(r);case 7:u=t.sent;case 8:if(u){t.next=10;break}return t.abrupt("return");case 10:return i=T.ECPair.fromPrivateKey(e.from(u),{network:B}),c=T.TransactionBuilder.fromTransaction(T.Transaction.fromHex(n),B),Object.keys(c.__PREV_TX_SET).length>1?Object.keys(c.__PREV_TX_SET).map((function(e,t){c.sign(t,i)})):c.sign(0,i),t.abrupt("return",c.build().toHex());case 16:return t.prev=16,t.t0=t.catch(3),console.error(t.t0),t.abrupt("return",null);case 20:case"end":return t.stop()}}),t,null,[[3,16]])}))),function(e,t){return d.apply(this,arguments)})},{key:"signerWithPopup",value:(u=(0,i.default)(a.default.mark((function e(t,n,r){var u=arguments;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.length>3&&void 0!==u[3]&&u[3],e.abrupt("return",new Promise(function(){var e=(0,i.default)(a.default.mark((function e(u){var c;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.messages=[{data:t.transaction,code:t.transaction.to,type:"transfer",authorization:t.transaction.from}],t.identityKey=w.default.get().state.scatter.keychain.identities[0].publicKey,t.participants=[n],t.network=n.network(),t.origin="Scatter",c={payload:t,origin:t.origin,blockchain:v.Blockchains.BTC,requiredFields:{},type:m.SIGN,id:1},g.default.emit("popout",c).then(function(){var e=(0,i.default)(a.default.mark((function e(i){var c,o;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=i.result)&&c.accepted){e.next=3;break}return e.abrupt("return",r({error:"Could not get signature"}));case 3:return e.next=5,P.default.sign(t.network,t.unsigned,n.publicKey,!0);case 5:if(o=e.sent){e.next=8;break}return e.abrupt("return",r({error:"Could not get signature"}));case 8:u(o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"requestParser",value:(r=(0,i.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Bitcoin not yet supported externally");case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}]),n}(d.default);t.default=C}).call(this,n("HDXh").Buffer)},x628:function(e,t,n){"use strict";var r=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=r(n("fWDP")),a=r(n("knbK")),i=r(n("Z4IU")),c=r(n("7OSH")),o=r(n("gW+t")),l=r(n("YhWJ")),s={initialize:function(e,t,n,r,u,o){var l=e.blockchains,s=e.plugins,f=e.nameParser,d=void 0===f?null:f,p=o.socketService,v=void 0===p?null:p,k=o.hardwareService,h=void 0===k?null:k,b=o.publicToPrivate,y=void 0===b?null:b,w=o.signer,m=void 0===w?null:w;return a.default.Blockchains.setBlockchains(l,d),i.default.PluginRepository.loadPlugins(s),c.default.utility.StoreService.init(t),c.default.secure.Seeder.init(n),c.default.utility.Framework.init(r),c.default.utility.EventService.init(u),v&&c.default.utility.SocketService.init(v),h&&c.default.secure.HardwareService.init(h),y&&c.default.secure.KeyPairService.init(y),m&&c.default.secure.SigningService.init(m),!0},migrations:u.default,models:a.default,plugins:i.default,services:c.default,store:o.default,util:l.default};t.default=s}}]);